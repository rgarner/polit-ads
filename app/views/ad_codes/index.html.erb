<%= render 'shared/breadcrumb' %>

<h1>Ad codes and their values</h1>

<ul class="tag-list">
  <% @ad_codes.each_pair do |name, values| %>
    <li>
     <%=
       link_to name, "##{name.downcase.gsub(' ', '-')}",
         class: values.first.quality <= 1 ? 'text-muted' : '',
         data: { turbolinks: false }
     %>
    </li>
  <% end %>
</ul>

<% @ad_codes.each_pair do |name, values| %>
  <div class="ad-code">
    <a name="<%= name.downcase.gsub(' ', '-') %>"></a>
    <h2 class="heading">
      <%= link_to name, campaign_ad_code_path(@campaign, values.first.index) %>
      <small class="text-muted">utm<%= values.first.index %></small>
    </h2>

    <h3 class="h5">
      <%= values.count %> values
      <% if values.count > 10 %>
        <small class="text-muted">
          â€“ showing 10,
          <%= link_to 'see more', campaign_ad_code_path(@campaign, values.first.index) %>
        </small>
      <% end %>

    </h3>
    <ul class="percentage-list">
      <% values.take(10).each do |value| %>
        <li>
          <span class="percentage" style="width: <%= value.percentage %>%"></span>

          <span class="content">
            <%= link_to campaign_ad_code_value_path(@campaign, value.index, value.value) do %>
              <span class="badge badge-primary"><%= value.value %></span>
              <% if value.value_name %>
                <%= value.value_name %>
              <% end %>
            <% end %>
            <small class="text-right">
              <%= link_to "#{value.percentage}% of adverts",
                adverts_path("with_utm_values[#{value.index}]" => "#{value.value}") %>
            </small>
          </span>

          <% if new_ad_code?(value, params[:new] || 2) %>
            <span class="badge badge-primary">New</span>
          <% end %>
        </li>
      <% end %>
    </ul>
  </div>
<% end %>
